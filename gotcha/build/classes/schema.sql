CREATE TABLE USERS (
	USERNAME 		VARCHAR(10) NOT NULL PRIMARY KEY,
	PASSWORD 		VARCHAR(8) NOT NULL,
	NICKNAME 		VARCHAR(20) UNIQUE,
	DESCRIPTION 	VARCHAR(50),
	PHOTO_URL 		VARCHAR(150),
	STATUS 			VARCHAR(6) NOT NULL,
	SIGNED_UP		TIMESTAMP NOT NULL,
	LAST_SEEN 		TIMESTAMP NOT NULL
);

CREATE TABLE CHANNELS (
	NAME 		VARCHAR(30) PRIMARY KEY,
	DESCRIPTION VARCHAR(500) NOT NULL,
	CREATED_BY 	VARCHAR(10) NOT NULL,
	CREATED 	TIMESTAMP NOT NULL,
	SUBSCRIBERS INTEGER
);

CREATE TABLE SUBSCRIPTIONS (
	ID 			INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	NICKNAME 	VARCHAR(20) NOT NULL REFERENCES USERS(NICKNAME) ON DELETE CASCADE,
	CHANNEL 	VARCHAR(30) NOT NULL REFERENCES CHANNELS(NAME) ON DELETE CASCADE
);

CREATE TABLE MESSAGES (
	ID 			INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	SENDER 		VARCHAR(20) NOT NULL REFERENCES USERS(NICKNAME) ON DELETE CASCADE,
	RECEIVER 	VARCHAR(30) NOT NULL,
	TEXT 		VARCHAR(500) NOT NULL,
	SENT_TIME 	TIMESTAMP NOT NULL
);